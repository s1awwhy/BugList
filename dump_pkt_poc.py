#!/usr/bin/env python3
from scapy.all import sendp, Raw, Ether
import argparse

# bytes of the raw packet
raw_packet = b"\x01\x00^\x00\x00\x05\xd6\x82o \x12*\x08\x00E\xc0\x01d\x83\xfb\x00\x00\x01YI\x7f\x0a\x00\x00\x02\xe0\x00\x00\x05\x02\x04\x01P\x0a\x00\xff\x02\x00\x00\x00\x00\x8a\xf8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x05\x00\x07\x02\x01\x0a\x00\xff\x04\x0a\x00\xff\x04\x80\x00\x00\x03\xc3\x08\x00<\x00\x00\x00\x03\x0a\x00\xff\x04\xff\xff\xff\xff\x03\x00\x00\x00\x0a\x00\xff\x02\x0a\x00\x04\x01\x01\x00\x00\x0a\x0a\x00\x04\x00\xff\xff\xff\x00\x03\x00\x00\x0a\x00\x02B\x0a\x08\x00\x00\x01\x0a\x00\xff\x04\x80\x00\x00\x01n\xfe\x00D\x00\x01\x00,\x01\x00\x00\x00\x0a\x00\xff\x02\x0a\x00\x04\x01\x00\x02\x00\x07\xe0\x00\x00\x00\x00\x13\x88\x00\x00\x02\x00\x07`\x00\x00\x00\x00\x13\x89\x00\x80\x00\x00\x04\x0a\x00\x04\x02\x00\x02B\x0a\x07\x00\x00\x01\x0a\x00\xff\x04\x80\x00\x00\x01x\x17\x00,\x00\x01\x00\x14\x01 \x00@\x0a\x00\xff\x04\x00\x02\x00\x08@\x00\x00\x00\x00\x00\x01\x90\x00\x02B\x0a\x04\x00\x00\x00\x0a\x00\xff\x04\x80\x00\x00\x01F&\x00L\x00\x01\x00\x04\x10\x00\x00\x00\x00\x08\x00\x01\x00\xff\xff\xff\x00\x09\x00\x0c\x00'\x10\x00\x00\x01\x00\x03\x00'\x10\x00\x00\x0e\x00\x0c\x00\x03\xe8\x00\x00\x01\x00\x03\x00\x13\x88\x00\x00\x0c\x00\x04\x00\x0c\x00\x00\x00\x07\x02\x01\x0a\x00\xff\x03\x0a\x00\xff\x03\x80\x00\x00\x03\x8fA\x00<\x00\x00\x00\x03\x0a\x00\xff\x03\xff\xff\xff\xff\x03\x00\x00\x00\x0a\x00\xff\x02\x0a\x00\x03\x01\x01\x00\x00\x0a\x0a\x00\x03\x00\xff\xff\xff\x00\x03\x00\x00\x0a"

# ====== Main ======
if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("-i", "--iface", required=True, help="Interface to send packet on (e.g., r1-eth0)")
    args = parser.parse_args()

    iface = args.iface
    print(f"[INFO] Sending raw OSPF packet on interface {iface}...")
    sendp(Raw(load=raw_packet), iface=iface, verbose=True)

